<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0a0a1a">
    <title>üó°Ô∏è –î—Ä–æ–±–Ω—ã–π –†—ã—Ü–∞—Ä—å ‚Äî –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ—Ä</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
    <div id="menu-screen" class="screen active">
        <div class="menu-container">
            <div class="title-section">
                <div class="castle-bg-decor"></div>
                <h1 class="game-title">
                    <span class="icon">‚öîÔ∏è</span>
                    <span class="text">–î–†–û–ë–ù–´–ô<br>–†–´–¶–ê–†–¨</span>
                    <span class="icon">üõ°Ô∏è</span>
                </h1>
                <p class="tagline">–°–ø–∞—Å–∏ –ø—Ä–∏–Ω—Ü–µ—Å—Å—É –∏–∑ –ë–∞—à–Ω–∏ –ß–∏—Å–µ–ª!</p>
            </div>
            
            <div class="menu-buttons">
                <button class="btn btn-primary" onclick="UI.showScreen('select-screen')">
                    üéÆ –ò–ì–†–ê–¢–¨
                </button>
                <button class="btn" onclick="UI.showScreen('tutorial-screen')">
                    üìñ –û–ë–£–ß–ï–ù–ò–ï
                </button>
                <button class="btn" onclick="UI.showScreen('records-screen')">
                    üèÜ –†–ï–ö–û–†–î–´
                </button>
            </div>
            
            <div class="hero-animation">
                <div class="knight-sprite"></div>
                <div class="dragon-sprite"></div>
            </div>
        </div>
    </div>

    <!-- –í—ã–±–æ—Ä –∏–≥—Ä–æ–∫–∞ -->
    <div id="select-screen" class="screen">
        <div class="screen-content">
            <div class="header">
                <button class="btn-back" onclick="UI.showScreen('menu-screen')">‚Üê –ù–∞–∑–∞–¥</button>
                <h2>üë• –í—ã–±–æ—Ä –≥–µ—Ä–æ—è</h2>
            </div>
            
            <div class="player-section">
                <div class="create-player">
                    <h3>‚ú® –ù–æ–≤—ã–π –≥–µ—Ä–æ–π</h3>
                    <input type="text" id="player-name-input" placeholder="–í–≤–µ–¥–∏ –∏–º—è..." maxlength="10">
                    <button class="btn btn-success" onclick="Players.create()">–°–æ–∑–¥–∞—Ç—å</button>
                </div>
                
                <div class="players-list-container">
                    <h3>üéÆ –ì–µ—Ä–æ–∏</h3>
                    <div id="players-list"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –û–±—É—á–µ–Ω–∏–µ -->
    <div id="tutorial-screen" class="screen">
        <div class="screen-content">
            <div class="header">
                <button class="btn-back" onclick="UI.showScreen('menu-screen')">‚Üê –ù–∞–∑–∞–¥</button>
                <h2>üìñ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å</h2>
            </div>
            
            <div class="tutorial-cards">
                <div class="tutorial-card">
                    <h3>üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
                    <div class="controls-grid">
                        <div class="control-item">
                            <span class="key">A</span> / <span class="key">‚Üê</span>
                            <span>–í–ª–µ–≤–æ</span>
                        </div>
                        <div class="control-item">
                            <span class="key">D</span> / <span class="key">‚Üí</span>
                            <span>–í–ø—Ä–∞–≤–æ</span>
                        </div>
                        <div class="control-item">
                            <span class="key">W</span> / <span class="key">‚Üë</span>
                            <span>–ü—Ä—ã–∂–æ–∫</span>
                        </div>
                    </div>
                </div>
                
                <div class="tutorial-card">
                    <h3>‚öîÔ∏è –ë–æ–π</h3>
                    <p>–ü–æ–¥–æ–π–¥–∏ –∫ –≤—Ä–∞–≥—É üëæ</p>
                    <p>–†–µ—à–∏ –ø—Ä–∏–º–µ—Ä –Ω–∞ –¥—Ä–æ–±–∏ üìù</p>
                    <p>–ü—Ä–∞–≤–∏–ª—å–Ω–æ = –≤—Ä–∞–≥ –ø–æ–±–µ–∂–¥—ë–Ω! ‚úÖ</p>
                </div>
                
                <div class="tutorial-card">
                    <h3>üóùÔ∏è –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ</h3>
                    <p>–°–æ–±–∏—Ä–∞–π –∫–ª—é—á–∏ üîë</p>
                    <p>–û—Ç–∫—Ä—ã–≤–∞–π –¥–≤–µ—Ä–∏ üö™</p>
                    <p>–ü–æ–±–µ–¥–∏ –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤ üëæ</p>
                    <p>–î–æ–π–¥–∏ –¥–æ –≤—ã—Ö–æ–¥–∞! üö©</p>
                </div>
                
                <div class="tutorial-card">
                    <h3>üí∞ –û—á–∫–∏</h3>
                    <p>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: +50</p>
                    <p>–ë—ã—Å—Ç—Ä—ã–π (<3 —Å–µ–∫): +25</p>
                    <p>–ö–æ–º–±–æ x3: +30</p>
                    <p>–ú–æ–Ω–µ—Ç–∫–∞: +10</p>
                </div>
            </div>
        </div>
    </div>

    <!-- –†–µ–∫–æ—Ä–¥—ã -->
    <div id="records-screen" class="screen">
        <div class="screen-content">
            <div class="header">
                <button class="btn-back" onclick="UI.showScreen('menu-screen')">‚Üê –ù–∞–∑–∞–¥</button>
                <h2>üèÜ –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ—Ä–¥–æ–≤</h2>
            </div>
            
            <div class="records-table">
                <div class="records-header">
                    <span>#</span>
                    <span>–ò–º—è</span>
                    <span>–£—Ä–æ–≤–µ–Ω—å</span>
                    <span>–û—á–∫–∏</span>
                </div>
                <div id="records-list"></div>
            </div>
        </div>
    </div>

    <!-- –ö–∞—Ä—Ç–∞ —É—Ä–æ–≤–Ω–µ–π -->
    <div id="map-screen" class="screen">
        <div class="screen-content">
            <div class="header">
                <button class="btn-back" onclick="UI.showScreen('select-screen')">‚Üê –ù–∞–∑–∞–¥</button>
                <h2>üè∞ –ë–∞—à–Ω—è –ß–∏—Å–µ–ª</h2>
                <div class="player-info">
                    <span id="map-player-name"></span>
                    <span id="map-player-score">üí∞ 0</span>
                </div>
            </div>
            
            <div class="tower-map">
                <div class="floor floor-4">
                    <span class="floor-label">–≠—Ç–∞–∂ 4: –î—Ä–∞–∫–æ–Ω üêâ</span>
                    <div class="levels-row" id="floor-4-levels"></div>
                </div>
                <div class="floor floor-3">
                    <span class="floor-label">–≠—Ç–∞–∂ 3: –ú–∞–≥ üßô</span>
                    <div class="levels-row" id="floor-3-levels"></div>
                </div>
                <div class="floor floor-2">
                    <span class="floor-label">–≠—Ç–∞–∂ 2: –ü—Ä–∏–∑—Ä–∞–∫ üëª</span>
                    <div class="levels-row" id="floor-2-levels"></div>
                </div>
                <div class="floor floor-1">
                    <span class="floor-label">–≠—Ç–∞–∂ 1: –ú—ã—à–∏ ü¶á</span>
                    <div class="levels-row" id="floor-1-levels"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
    <div id="game-screen" class="screen">
        <!-- HUD -->
        <div id="hud">
            <div class="hud-left">
                <div class="hearts" id="hud-hearts"></div>
                <div class="stat keys">üóùÔ∏è <span id="hud-keys">0/0</span></div>
            </div>
            <div class="hud-center">
                <div class="level-name" id="hud-level">–£—Ä–æ–≤–µ–Ω—å 1</div>
                <div class="enemies-left">üëæ <span id="hud-enemies">0/0</span></div>
            </div>
            <div class="hud-right">
                <div class="stat score">üí∞ <span id="hud-score">0</span></div>
                <div class="stat combo">üî• <span id="hud-combo">0</span></div>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
        <canvas id="game-canvas"></canvas>

        <!-- –ö–Ω–æ–ø–∫–∞ –ø–∞—É–∑—ã -->
        <button id="pause-btn" onclick="Game.pause()">‚è∏Ô∏è</button>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–æ—è -->
        <div id="battle-modal" class="modal hidden">
            <div class="modal-box battle-box">
                <div class="enemy-info">
                    <span class="enemy-sprite" id="battle-sprite">ü¶á</span>
                    <span class="enemy-name" id="battle-name">–õ–µ—Ç—É—á–∞—è –º—ã—à—å</span>
                </div>
                <div class="question-section">
                    <div class="question" id="battle-question">1/2 + 1/4 = ?</div>
                    <div class="timer-bar"><div class="timer-fill" id="battle-timer"></div></div>
                </div>
                <div class="answers-grid" id="battle-answers"></div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–∞—É–∑—ã -->
        <div id="pause-modal" class="modal hidden">
            <div class="modal-box">
                <h2>‚è∏Ô∏è –ü–∞—É–∑–∞</h2>
                <div class="modal-buttons">
                    <button class="btn btn-primary" onclick="Game.resume()">‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
                    <button class="btn" onclick="Game.restart()">üîÑ –ó–∞–Ω–æ–≤–æ</button>
                    <button class="btn btn-danger" onclick="Game.exitToMap()">üö™ –í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–±–µ–¥–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ -->
    <div id="win-screen" class="screen">
        <div class="result-box victory">
            <h1>üéâ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!</h1>
            <div class="result-stats">
                <div class="stat-item">
                    <span class="label">–£—Ä–æ–≤–µ–Ω—å</span>
                    <span class="value" id="win-level">1</span>
                </div>
                <div class="stat-item">
                    <span class="label">–û—á–∫–∏</span>
                    <span class="value" id="win-score">0</span>
                </div>
                <div class="stat-item">
                    <span class="label">–ö–æ–º–±–æ</span>
                    <span class="value" id="win-combo">0</span>
                </div>
            </div>
            <div class="result-buttons">
                <button class="btn btn-primary" onclick="Game.nextLevel()">‚û°Ô∏è –î–∞–ª—å—à–µ</button>
                <button class="btn" onclick="UI.showScreen('map-screen'); Map.render();">üó∫Ô∏è –ö–∞—Ä—Ç–∞</button>
            </div>
        </div>
    </div>

    <!-- –ü–æ—Ä–∞–∂–µ–Ω–∏–µ -->
    <div id="lose-screen" class="screen">
        <div class="result-box defeat">
            <h1>üíÄ –ü–æ—Ä–∞–∂–µ–Ω–∏–µ</h1>
            <p>–ù–µ —Å–¥–∞–≤–∞–π—Å—è! –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞!</p>
            <div class="result-stats">
                <div class="stat-item">
                    <span class="label">–û—á–∫–∏</span>
                    <span class="value" id="lose-score">0</span>
                </div>
            </div>
            <div class="result-buttons">
                <button class="btn btn-primary" onclick="Game.restart()">üîÑ –ó–∞–Ω–æ–≤–æ</button>
                <button class="btn" onclick="UI.showScreen('map-screen'); Map.render();">üó∫Ô∏è –ö–∞—Ä—Ç–∞</button>
            </div>
        </div>
    </div>

    <!-- –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–±–µ–¥–∞ -->
    <div id="final-screen" class="screen">
        <div class="result-box final-victory">
            <div class="confetti"></div>
            <h1>üëë –ü–û–ë–ï–î–ê! üëë</h1>
            <div class="princess-saved">
                <span class="princess">üë∏</span>
                <p>–ü—Ä–∏–Ω—Ü–µ—Å—Å–∞ –î—Ä–æ–±–∏–Ω–∫–∞ —Å–ø–∞—Å–µ–Ω–∞!</p>
            </div>
            <div class="result-stats">
                <div class="stat-item big">
                    <span class="label">–ò—Ç–æ–≥–æ–≤—ã–π —Å—á—ë—Ç</span>
                    <span class="value" id="final-score">0</span>
                </div>
            </div>
            <div class="result-buttons">
                <button class="btn btn-primary" onclick="UI.showScreen('menu-screen')">üè† –ú–µ–Ω—é</button>
                <button class="btn" onclick="UI.showScreen('records-screen'); Records.render();">üèÜ –†–µ–∫–æ—Ä–¥—ã</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
    <div id="mobile-controls">
        <button class="mobile-btn left" id="mobile-left">‚óÄ</button>
        <button class="mobile-btn right" id="mobile-right">‚ñ∂</button>
        <button class="mobile-btn jump" id="mobile-jump">‚ñ≤</button>
        <button class="mobile-btn pause" id="mobile-pause">‚è∏</button>
    </div>

    <script src="js/game.js"></script>
</body>
</html>
